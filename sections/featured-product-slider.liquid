{{ 'product-slider.css' | asset_url | stylesheet_tag }}

<section class="featured-product-slider m-auto flickity-width">
  {%- for block in section.blocks -%}
    <div class="carousel">
      {% assign product = all_products[block.settings.product_item] %}
      <div class="mb-12 mt-12 carousel-cell">
        <div class="product-card flex flex-col m-auto mb-20 relative my-1 content-card items-center h-[385px] w-[418px] bg-white">
          <a class="add_to_cart" var_id="{{ product.variants.first.id }}">
            <div>
              {% if product.featured_image != blank %}
                <img class="h-[313px]" src="{{ product.featured_image | image_url: width: 1500 }}" />
              {% else %}
                {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg placeholder placeholder-img' }}
              {% endif %}
            </div>
            <div id="card-text" class="flex-row justify-between px-5 flex items-center bottom-4 absolute translate-x[-50%] gap-2 text-black w-full">
              <div class="text-3xl font-GTlight">
                {% if product.title != blank %}
                  {{ product.title | strip }}
                {% else %}
                  <span>Title</span>
                {% endif %}
              </div>
              <div class="flex-col items-center font-PT-r tracking-widest mt-3 font-medium gap-4 text-center text-sm uppercase">
                <div>
                  {% if product.price != blank %}
                    {{ product.price | money_without_trailing_zeros }}
                  {% else %}
                    <span>$20</span>
                  {% endif %}

                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  {% endfor %}
</section>

<script type="text/javascript">
  var elem = document.querySelector('.featured-product-slider');
  var flkty = new Flickity(elem, {
      contain: true,
      imagesLoaded: true,
      wrapAround: true,
      pageDots: false,
      cellAlign: 'center',
      freeScroll: true,
      draggable: false,
      arrowShape: 'M26.7142 5.64384C25.2109 4.43753 23.6151 2.73144 22.4294 0.743896L21.5706 1.25623C22.8249 3.35869 24.5041 5.15259 26.0883 6.42378C26.8808 7.0597 27.6579 7.57158 28.3557 7.92701C28.4035 7.95135 28.4512 7.97509 28.4987 7.99819C28.4516 8.02093 28.4044 8.0443 28.357 8.06826C27.659 8.42129 26.8817 8.93039 26.0889 9.56463C24.5041 10.8325 22.8243 12.627 21.5698 14.7453L22.4302 15.2548C23.6157 13.2531 25.2109 11.5476 26.7136 10.3455C27.4645 9.74474 28.1841 9.27634 28.8083 8.96061C29.4466 8.63777 29.9356 8.50006 30.24 8.50006V7.50006C29.9367 7.50006 29.4483 7.36126 28.8096 7.03593C28.1852 6.71792 27.4654 6.24668 26.7142 5.64384Z'
    });
                            
  $(document).on('click','.add_to_cart',function(){
  var obj=$(this);
 
  $.ajax({
    type: 'POST',
    url: '/cart/add',
    data: {
      quantity: 1,
      id: $(this).attr("var_id")
    },
    dataType: 'json', 
    success: function (data) {  
      alert('Item added to cart');
    } 
  });
})</script>
{% schema %}
  {
    "name": "Featured Product Slider",
    "tag": "section",
    "class": "section",
    "max_blocks": 6,
    "settings": [
      {
        "type": "range",
        "id": "cards_desktop",
        "min": 1,
        "max": 6,
        "step": 1,
        "default": 6,
        "label": "Desktop Cards"
      }
    ],
    "blocks": [
      {
        "type": "card_block",
        "name": "Card Block",
        "settings": [
          {
            "id": "product_item",
            "type": "product",
            "label": "Choose the Product you want displayed"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Featured Product Slider",
        "blocks": [
          {
            "type": "card_block"
          }, {
            "type": "card_block"
          }
        ]
      }
    ]
  }
{% endschema %}